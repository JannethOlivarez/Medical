<!-- Mensaje de pantalla -->
<p-toast></p-toast>
<!--Diaologo de Confirmacion-->
<p-confirmDialog [style]="{width: '50vw'}" [baseZIndex]="10000" rejectButtonStyleClass="p-button-text">
</p-confirmDialog>

    <div class="row">
        <div class="card">
            <!-- Tabla de roles -->
            <p-panel>
                <ng-template class="grid" pTemplate="header">
                    <div>
                        <button pButton type="button" class=" p-button p-button-warning" label="Agregar"
                            icon="pi pi-plus" (click)="showDialogToAdd(myform)"></button>
                    </div>
                </ng-template>
                <p-table #dt1 [value]="registros" dataKey="id" [rows]="6" [loading]="loading" [rowHover]="true"
                    styleClass="p-datatable-gridlines" [paginator]="true"
                    [globalFilterFields]="['name','country.name','representative.name','status']"
                    responsiveLayout="scroll">
                    <ng-template pTemplate="header">
                        <tr>
                            <th>
                                <div class="flex justify-content-between align-items-center">
                                    Nombres
                                </div>
                            </th>
                            <th>
                                <div class="flex justify-content-between align-items-center">
                                    Permisos
                                </div>
                            </th>
                            <th style="width: 8rem">
                                <div class="flex justify-content-between align-items-center">
                                    Opciones
                                </div>
                            </th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr>
                            <td style="min-width: 6rem;">
                                <span class="image-text ml-2">{{item.nombre}}</span>
                            </td>
                            <td style="min-width: 8rem;">
                                <ul>
                                    <li *ngFor="let permiso of item.permisos">
                                        {{permiso.tituloModulo}}
                                    </li>
                                </ul>
                            </td>
                            <td class="text-center" style="min-width: 6rem;">
                                <button (click)="editar(item)" pButton pRipple type="button" icon="pi pi-pencil"
                                    class="p-button-rounded mr-2 mb-2 p-button-warning"></button>
                                <button pButton pRipple type="button" icon="pi pi-trash"
                                    class="p-button-rounded mr-2 mb-2 p-button-danger"
                                    (click)="confirmarEliminacion(item)"></button>
                            </td>
                        </tr>
                    </ng-template>
                </p-table>
            </p-panel>


        </div>
    </div>
    <!-- Dialogo de creacion y Actualizacion -->
    <p-dialog appendTo="body" [(visible)]="displayDialog" [style]="{width: '40vw'}" [responsive]="true"
        [baseZIndex]="10000" [draggable]="false" [resizable]="false" [modal]="true">
        <ng-template pTemplate="header">
            <label style="font-size: large; font-weight: 700;">Permisos</label>
        </ng-template>
        <div class="ui-g ui-fluid" *ngIf="registro">
            <div class="ui-g-12" style="padding: 3%;">
                <div class="ui-g-4">
                    <label class="col-4" for="nombre">Nombre</label>
                    <input pInputText id="nombre" name="nombre"
                        [(ngModel)]="registro.nombre" />
                </div>
            </div>
            <div class="ui-g-12">
                <p-listbox [options]="permisos" name="permisos" [(ngModel)]="registro.permisos" multiple="multiple"
                    checkbox="checkbox" filter="filter" optionLabel="tituloModulo">
                    <p-header>
                        <i class="fa fa-car"></i>
                        Permisos
                    </p-header>
                </p-listbox>

            </div>
        </div>
        <br>
        <p-footer>
            <div class="ui-dialog-buttonpane ui-helper-clearfix">
                <button type="button" pButton icon="pi pi-times" class=" p-button p-button-secondary"
                    (click)="displayDialog=false" label="Cancelar"></button>
                <button *ngIf="disabledEraser==false" type="button" pButton icon="pi pi-times"
                    class=" p-button p-button-danger" label="Borrar"></button>
                <button type="button" pButton icon="pi pi-check" class=" p-button p-button-success" (click)=" guardarRolesPermisos()"
                    label="Guardar"></button>
            </div>
        </p-footer>
    </p-dialog>
